/******************************************************************************
	クラリオン殿向け
	プロジェクト名	: 2012年AMFM_RADIOモデル
	ファイル名		: key_func_ext.c
	機能			: Keyモジュール外部参照関数群
------------------------------------------------------------------------------
日付		担当者		修正内容
2012/07/26	東海林		新規作成
******************************************************************************/
#define	_KEY_FUNC_C_

#include	"../comm/common.h"
#include	"../io/IO_inc.h"
#include	"../power/pw_func_ext.h"
#include	"key_def.h"
#include	"key_func_ext.h"
#include	"key_sys.h"
#include	"key_main.h"

/*	----------------------------------------*/
/*	関数プロトタイプ宣言（ローカル関数）	*/
/*	----------------------------------------*/

#if 0
/******************************************************************************
	関数名	：Key_pwrhalt_chk
	引	数	：無し
	戻り値	：TRUE ⇒ Power OFF HALTから起き上がる要求あり
			：FALSE ⇒ 要求無し
	機	能	：PowerOFF HALTモード中キーでの起き上がる要求チェック処理
	備	考	：LCDキー検出あり
------------------------------------------------------------------------------
日付		担当者		修正内容
2012/07/26	東海林		新規作成
******************************************************************************/
BOOL	Key_pwrhalt_chk(void)
{
	if(( MIO_IN_pLCDDO() == LOW) ||					/*	LCD Key on ?	*/
	   (key_lcd_input != CKEY_ID_KEY_OFF))			/* LCDキー取り込み中 */
	{
		return(TRUE);
	}

	fkey_alldis = OFF;			/* PowerOFFHALT中キー有効 */

	return(FALSE);
}
#endif

/******************************************************************************
	関  数  名		：Key_1ms_timer
	引      数		：無し
	戻  り  値		：無し
	機  能  概  略	：Key Module 1ms インターバル処理
------------------------------------------------------------------------------
日付		担当者		修正内容
2012/07/26	東海林		新規作成
******************************************************************************/
void	Key_1ms_timer(void)
{

}

/******************************************************************************
	関  数  名		：Key_5ms_timer
	引      数		：無し
	戻  り  値		：無し
	機  能  概  略	：Key Module 5ms インターバル処理
					  5msベースタイマカウント処理
	コ  メ  ン  ト	：5ms割込み処理よりCallされる。
------------------------------------------------------------------------------
日付		担当者		修正内容
2012/07/26	東海林		新規作成
******************************************************************************/
void	Key_5ms_timer(void)
{
	if (key_lcd_input_Timer > CKEY_TIME_UP)
	{
		key_lcd_input_Timer--;
	}
	return;
}

void	Key_10ms_timer_accoff(void)
{
	if (key_long_timer != 0xff)
	{
		if(key_long_timer > CKEY_TIME_UP)
		{
			key_long_timer--;
		}
	}

}
/******************************************************************************
	関  数  名		：Key_check_stop
	引      数		：無し
	戻  り  値		：無し
	機  能  概  略	：Key 入力禁止処理
	コ  メ  ン  ト	：Powerモジュールより電源状態遷移中にCallされる。
------------------------------------------------------------------------------
日付		担当者		修正内容
2012/07/26	東海林		新規作成
******************************************************************************/
void	Key_check_stop(void)
{
	key_in_disable_timer = CKEY_IN_TIMER_MAX;
	fkey_alldis = ON;
	fkey_nop = ON;
	return;
}

/******************************************************************************
	関  数  名		：Key_check_start
	引      数		：無し
	戻  り  値		：無し
	機  能  概  略	：Key 入力許可処理
	コ  メ  ン  ト	：Powerモジュールより電源状態遷移中にCallされる。
------------------------------------------------------------------------------
日付		担当者		修正内容
2012/07/26	東海林		新規作成
******************************************************************************/
void	Key_check_start(void)
{
	key_in_disable_timer = 0;
	return;
}
/******************************************************************************
	関  数  名		：Key_check_start
	引      数		：無し
	戻  り  値		：無し
	機  能  概  略	：Key 入力禁止処理
	コ  メ  ン  ト	：メイン各モードモジュールでのKey動作処理でCallされる。
------------------------------------------------------------------------------
日付		担当者		修正内容
2012/07/26	東海林		新規作成
******************************************************************************/
void	Key_nop(void)
{
	if (fkey_prio_key == ON)			/* 優先キー動作中 */
	{
		fkey_alldis = ON;				/* ALLキー禁止 */
	}
	else
	{
		fkey_nop = ON;
	}
	key_new_key = CKEY_ID_KEY_OFF;
	key_old_key = CKEY_ID_KEY_OFF;
	key_now_key = CKEY_ID_KEY_OFF;
	return;
}

/******************************************************************************
	関  数  名		：Key_long_time200
	引      数		：無し
	戻  り  値		：無し
	機  能  概  略	：Long Key 判定用タイマー設定処理
					  LongKey確定時間200msカウント値を設定する。
	コ  メ  ン  ト	：メイン各モードモジュールよりCallされる。
					  ※ベースタイマー値は50ms設定  カウント  ＝  200/50 (= 10)
------------------------------------------------------------------------------
日付		担当者		修正内容
2012/07/26	東海林		新規作成
******************************************************************************/
void	Key_long_time200(void)
{
	key_long_timer = CKEY_LONG_WAIT_TIME200;
}
/******************************************************************************
	関  数  名		：Key_long_time500
	引      数		：無し
	戻  り  値		：無し
	機  能  概  略	：Long Key 判定用タイマー設定処理
					  Long Key確定時間500msカウント値を設定する。
	コ  メ  ン  ト	：メイン各モードモジュールよりCallされる。
					  ※ベースタイマー値は50ms設定  カウント  ＝  500/50 (= 10)
------------------------------------------------------------------------------
日付		担当者		修正内容
2012/07/26	東海林		新規作成
******************************************************************************/
void	Key_long_time500(void)
{
	key_long_timer = CKEY_LONG_WAIT_TIME500;
}

/******************************************************************************
	関  数  名		：Key_long_time1000
	引      数		：無し
	戻  り  値		：無し
	機  能  概  略	：Long Key 判定用タイマー設定処理
					  Long Key確定時間１秒カウント値を設定する。
	コ  メ  ン  ト	：メイン各モードモジュールよりCallされる。
					※ベースタイマー値は50ms設定  カウント  ＝  1000/50 (= 20)
------------------------------------------------------------------------------
日付		担当者		修正内容
2012/07/26	東海林		新規作成
******************************************************************************/
void	Key_long_time1000(void)
{
	key_long_timer = CKEY_LONG_WAIT_TIME1000;
}

/******************************************************************************
	関  数  名		：Key_long_time2000
	引      数		：無し
	戻  り  値		：無し
	機  能  概  略	：Long Key 判定用タイマー設定処理
					  Long Key確定時間２秒カウント値を設定する。
	コ  メ  ン  ト	：メイン各モードモジュールよりCallされる。
					※ベースタイマー値は50ms設定  カウント  ＝  2000/50 (= 40)
------------------------------------------------------------------------------
日付		担当者		修正内容
2012/07/26	東海林		新規作成
******************************************************************************/
void	Key_long_time2000(void)
{
	key_long_timer = CKEY_LONG_WAIT_TIME2000;
}

void	Key_long_time2000_accoff(void)
{
	key_long_timer = CKEY_LONG_WAIT_TIME2000_ACCOFF;
}

/******************************************************************************
	関数名	：Key_get_priokey
	引  数	：無し
	戻り値	：ON:fkey_alldis = ON, OFF:fkey_alldis = OFF
	機  能	：fkey_alldisの状態を返す
------------------------------------------------------------------------------
日付		担当者		修正内容
2012/07/26	東海林		新規作成
******************************************************************************/
BYTE	Key_get_priokey(void)
{
	BYTE	result;

	result = OFF;

	if (fkey_prio_key == ON)			/* 優先キー動作中 */
	{
		result = ON;					/* ON */
	}
	return( result );
}


void Key_testmode_func(BYTE RcvCmd,BYTE *RcvBuf,BYTE Length)
{
	key_test_sta = CKEY_TSET_INPUT;
}
#undef _KEY_FUNC_C_